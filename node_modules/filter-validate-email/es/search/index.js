import { regexpAsciiEmail, regexpUnicodeEmail } from '../regexp';
export function searchEmails(input) {
  var unicode = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;
  return (unicode ? searchUnicodeEmails : searchAsciiEmails)(input);
}
export function searchAsciiEmails(input) {
  return search('ascii', regexpAsciiEmail, input);
}
export function searchUnicodeEmails(input) {
  return search('unicode', regexpUnicodeEmail, input);
}
export default searchEmails;

var search = function search(type, regexp, input) {
  var emails = ((typeof input === 'string' ? input : '').match(transform(type, regexp)) || []).filter(function (email) {
    return email.length <= 320 && email.slice(-1) !== '\n' && encodeURIComponent(email).replace(/%../g, 'x').length <= 320;
  });
  return emails.length ? emails : null;
};

var cache = Object.create(null);

var transform = function transform(type, regexp) {
  return cache[type] || (cache[type] = new RegExp(regexp.source.slice(1, -1), "".concat(regexp.flags, "g")));
};