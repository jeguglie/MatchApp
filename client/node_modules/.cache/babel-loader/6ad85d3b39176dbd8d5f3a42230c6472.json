{"ast":null,"code":"var _jsxFileName = \"/Users/jv/Desktop/MatchApp/client/src/containers/Wall/Wall.js\";\nimport React from 'react';\nimport { withRouter } from \"react-router\";\nimport UserMiniCard from \"../../components/UserMiniCard/UserMiniCard\";\nimport API from './../../utils/API';\nimport InfiniteScroll from 'react-infinite-scroller';\nimport { Button, Grid, Divider, Icon } from \"semantic-ui-react\";\nimport ModalUser from '../../components/ModalUser/ModalUser';\nimport { store } from \"react-notifications-component\";\nimport Filter from './Filter/Filter';\nconst DEFAULT_STATE = {\n  loadingModal: '',\n  nextUsers: '',\n  hasMoreContent: false,\n  clear: false,\n  users: [],\n  warnings: [],\n  loading: true,\n  userView: false,\n  userIdFocusLoading: null,\n  interests: [],\n  visible: false,\n  aDescendant: false,\n  dDescendant: false\n};\n\nclass Wall extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = async () => {\n      this._mounted = true;\n      this._mounted && this.setState({\n        loading: true\n      });\n      await API.checkUserView().then(res => {\n        if (res.status === 200) {\n          this._mounted && this.setState({\n            userView: true\n          });\n          this.searchMatch(this.state.distanceRange, this.state.ageRange, this.state.popularityRange);\n        }\n      }).catch(() => {\n        store.addNotification({\n          message: \"Please complete your profile\",\n          type: \"info\",\n          insert: \"top\",\n          container: \"top-right\",\n          animationIn: [\"animated\", \"fadeIn\"],\n          animationOut: [\"animated\", \"fadeOut\"],\n          dismiss: {\n            duration: 5000,\n            onScreen: true\n          }\n        });\n        this.props.history.push('/profile');\n      });\n    };\n\n    this.searchMatch = async (distanceRange, ageRange, popularityRange) => {\n      this._mounted && this.setState({\n        loading: true\n      });\n      let users = [];\n      await API.getUsers(distanceRange, ageRange, popularityRange).then(response => {\n        if (response.status === 200) users = response.data.users;\n      });\n      let nextUsers = 0;\n      if (users.length > 20) nextUsers = users.slice(21);\n      this._mounted && this.setState({\n        nextUsers: nextUsers,\n        users: users.slice(0, 21),\n        hasMoreContent: users.length > 20\n      });\n      this._mounted && this.setState({\n        loading: false\n      });\n    };\n\n    this.clickedUser = async userIdFocus => {\n      // Send notification\n      this.props.sWallVisit(userIdFocus); // Inner Ref Modal\n\n      this.innerRefModal.current && this.innerRefModal.current.loadUser(userIdFocus);\n      this._mounted && this.setState({\n        loadingMinCard: true,\n        userIdFocusLoad: userIdFocus\n      });\n    };\n\n    this.handleBottomPage = () => {\n      const {\n        nextUsers,\n        users\n      } = this.state;\n\n      if (nextUsers.length) {\n        for (let i = 0; i < nextUsers.length && i <= 20; i++) users.push(nextUsers[i]);\n\n        this._mounted && this.setState({\n          users: users,\n          nextUsers: nextUsers.slice(21)\n        });\n      } else this._mounted && this.setState({\n        hasMoreContent: false\n      });\n    };\n\n    this.ageFilter = () => {\n      const {\n        aDescendant\n      } = this.state;\n      this.innerRef.current && this.innerRef.current.ageFilter(aDescendant);\n      this.setState({\n        aDescendant: !aDescendant\n      });\n    };\n\n    this.distanceFilter = () => {\n      const {\n        dDescendant\n      } = this.state;\n      this.innerRef.current && this.innerRef.current.distanceFilter(dDescendant);\n      this.setState({\n        dDescendant: !dDescendant\n      });\n    };\n\n    this.state = { ...DEFAULT_STATE\n    };\n    this._mounted = false;\n    this.innerRefModal = React.createRef();\n    this.innerRef = React.createRef();\n  }\n\n  componentWillUnmount() {\n    this._mounted = false;\n  } // Search button handle\n\n\n  render() {\n    const {\n      hasMoreContent,\n      users,\n      aDescendant,\n      dDescendant,\n      userIdFocusLoad\n    } = this.state;\n    const userscards = React.createElement(Grid.Column, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, React.createElement(Grid.Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: 'ButtonFilters',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, React.createElement(Button.Group, {\n      size: 'small',\n      widths: 3,\n      fluid: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, React.createElement(Button, {\n      onClick: this.ageFilter,\n      icon: true,\n      labelPosition: \"left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: aDescendant ? 'arrow down' : 'arrow up',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }), \"Age\"), React.createElement(Button, {\n      onClick: this.distanceFilter,\n      icon: true,\n      labelPosition: \"left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: dDescendant ? 'arrow down' : 'arrow up',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }), \"Distance\"), React.createElement(Button, {\n      onClick: () => this.searchMatch(this.state.distanceRange, this.state.ageRange, this.state.popularityRange),\n      icon: true,\n      labelPosition: \"left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: \"list ol\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }), \"Match\")))), React.createElement(Divider, {\n      hidden: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }), React.createElement(Grid, {\n      stackable: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150\n      },\n      __self: this\n    }, React.createElement(UserMiniCard, {\n      userIdFocus: userIdFocusLoad,\n      inner: true,\n      users: users,\n      ref: this.innerRef,\n      clickedUser: this.clickedUser,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    })));\n    return React.createElement(\"div\", {\n      className: \"WallContainer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, React.createElement(ModalUser, {\n      s_like: this.props.s_like,\n      s_like_unliked: this.props.s_like_unliked,\n      s_like_likedback: this.props.s_like_likedback,\n      ref: this.innerRefModal,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }), React.createElement(Grid, {\n      centered: true,\n      columns: 'equal',\n      stackable: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, React.createElement(Filter, {\n      searchMatch: () => this.searchMatch(this.state.distanceRange, this.state.ageRange, this.state.popularityRange),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }), userscards), React.createElement(InfiniteScroll, {\n      pageStart: 0,\n      loadMore: this.handleBottomPage,\n      hasMore: hasMoreContent,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, \" \"));\n  }\n\n}\n\nexport default withRouter(Wall);","map":{"version":3,"sources":["/Users/jv/Desktop/MatchApp/client/src/containers/Wall/Wall.js"],"names":["React","withRouter","UserMiniCard","API","InfiniteScroll","Button","Grid","Divider","Icon","ModalUser","store","Filter","DEFAULT_STATE","loadingModal","nextUsers","hasMoreContent","clear","users","warnings","loading","userView","userIdFocusLoading","interests","visible","aDescendant","dDescendant","Wall","Component","constructor","props","componentDidMount","_mounted","setState","checkUserView","then","res","status","searchMatch","state","distanceRange","ageRange","popularityRange","catch","addNotification","message","type","insert","container","animationIn","animationOut","dismiss","duration","onScreen","history","push","getUsers","response","data","length","slice","clickedUser","userIdFocus","sWallVisit","innerRefModal","current","loadUser","loadingMinCard","userIdFocusLoad","handleBottomPage","i","ageFilter","innerRef","distanceFilter","createRef","componentWillUnmount","render","userscards","s_like","s_like_unliked","s_like_likedback"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { withRouter } from \"react-router\";\nimport UserMiniCard from \"../../components/UserMiniCard/UserMiniCard\";\nimport API from './../../utils/API';\nimport InfiniteScroll from 'react-infinite-scroller';\nimport { Button, Grid, Divider, Icon } from \"semantic-ui-react\";\nimport ModalUser from '../../components/ModalUser/ModalUser';\nimport { store } from \"react-notifications-component\";\nimport Filter from './Filter/Filter';\n\nconst DEFAULT_STATE = {\n    loadingModal: '',\n    nextUsers: '',\n    hasMoreContent: false,\n    clear: false,\n    users: [],\n    warnings: [],\n    loading: true,\n    userView: false,\n    userIdFocusLoading: null,\n    interests: [],\n    visible: false,\n    aDescendant: false,\n    dDescendant: false,\n\n};\nclass Wall extends React.Component {\n\n    constructor(props){\n        super(props);\n        this.state = {...DEFAULT_STATE};\n        this._mounted = false;\n        this.innerRefModal = React.createRef();\n        this.innerRef = React.createRef();\n    }\n\n    componentDidMount = async() => {\n        this._mounted = true;\n        this._mounted && this.setState({loading: true});\n        await API.checkUserView()\n            .then(res => {\n                if (res.status === 200) {\n                    this._mounted && this.setState({userView: true});\n                    this.searchMatch(this.state.distanceRange, this.state.ageRange, this.state.popularityRange);\n                }\n            })\n            .catch( () => {\n                store.addNotification({\n                    message: \"Please complete your profile\",\n                    type: \"info\",\n                    insert: \"top\",\n                    container: \"top-right\",\n                    animationIn: [\"animated\", \"fadeIn\"],\n                    animationOut: [\"animated\", \"fadeOut\"],\n                    dismiss: {\n                        duration: 5000,\n                        onScreen: true\n                    }\n                });\n                this.props.history.push('/profile');\n            });\n    };\n\n    componentWillUnmount() {\n        this._mounted = false;\n    }\n\n    // Search button handle\n    searchMatch = async(distanceRange, ageRange, popularityRange) => {\n        this._mounted && this.setState({loading: true})\n        let users = [];\n        await API.getUsers(distanceRange, ageRange, popularityRange)\n            .then(response => {\n                if (response.status === 200)\n                    users = response.data.users;\n            });\n        let nextUsers = 0;\n        if(users.length > 20)\n           nextUsers = users.slice(21);\n        this._mounted && this.setState({\n            nextUsers: nextUsers,\n            users: users.slice(0, 21),\n            hasMoreContent: users.length > 20\n        });\n        this._mounted && this.setState({loading: false});\n\n    };\n\n\n    clickedUser = async(userIdFocus) => {\n        // Send notification\n        this.props.sWallVisit(userIdFocus);\n        // Inner Ref Modal\n        this.innerRefModal.current && this.innerRefModal.current.loadUser(userIdFocus);\n        this._mounted && this.setState({ loadingMinCard: true, userIdFocusLoad: userIdFocus});\n    };\n    handleBottomPage = () => {\n        const { nextUsers, users } = this.state;\n        if (nextUsers.length){\n            for (let i = 0; i < nextUsers.length && i <= 20; i++)\n                users.push(nextUsers[i]);\n            this._mounted && this.setState({users: users, nextUsers: nextUsers.slice(21)});\n        }\n        else\n            this._mounted && this.setState({hasMoreContent: false});\n    };\n    // Filters\n    ageFilter = () => {\n        const {aDescendant } = this.state;\n        this.innerRef.current && this.innerRef.current.ageFilter(aDescendant);\n        this.setState({aDescendant: !aDescendant});\n    };\n\n    distanceFilter = () => {\n        const {dDescendant } = this.state;\n        this.innerRef.current && this.innerRef.current.distanceFilter(dDescendant);\n        this.setState({dDescendant: !dDescendant});\n    };\n\n    render() {\n        const { hasMoreContent, users, aDescendant, dDescendant, userIdFocusLoad} = this.state;\n        const userscards = (\n            <Grid.Column>\n                <Grid.Row>\n                    <div className={'ButtonFilters'}>\n                        <Button.Group size={'small'} widths={3} fluid>\n                            <Button\n                                onClick={this.ageFilter}\n                                icon\n                                labelPosition='left'>\n                                <Icon name={aDescendant ? 'arrow down' : 'arrow up'}/>Age</Button>\n                            <Button\n                                onClick={this.distanceFilter}\n                                icon\n                                labelPosition='left'>\n                                <Icon name={dDescendant ? 'arrow down' : 'arrow up'} />\n                                Distance\n                            </Button>\n                            <Button\n                                onClick={() => this.searchMatch(this.state.distanceRange, this.state.ageRange, this.state.popularityRange)}\n                                icon\n                                labelPosition='left'>\n                                <Icon name='list ol' />\n                                Match\n                            </Button>\n                        </Button.Group>\n                    </div>\n                </Grid.Row>\n                <Divider hidden/>\n                <Grid stackable >\n                    <UserMiniCard\n                        userIdFocus={userIdFocusLoad}\n                        inner\n                        users={users}\n                        ref={this.innerRef}\n                        clickedUser={this.clickedUser}\n                    />\n                </Grid>\n            </Grid.Column>\n        );\n\n        return (\n            <div className=\"WallContainer\">\n                <ModalUser s_like={this.props.s_like} s_like_unliked={this.props.s_like_unliked} s_like_likedback={this.props.s_like_likedback} ref={this.innerRefModal} />\n                <Grid centered columns={'equal'} stackable>\n                    <Filter searchMatch={() => this.searchMatch(this.state.distanceRange, this.state.ageRange, this.state.popularityRange)} />\n                    {userscards}\n                </Grid>\n                <InfiniteScroll\n                    pageStart={0}\n                    loadMore={this.handleBottomPage}\n                    hasMore={hasMoreContent}\n                > </InfiniteScroll>\n            </div>\n        );\n    }\n}\n\nexport default withRouter(Wall);"]},"metadata":{},"sourceType":"module"}