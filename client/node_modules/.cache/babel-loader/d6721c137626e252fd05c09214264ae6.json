{"ast":null,"code":"import _defineProperty from\"/Users/jeguglie/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/Users/jeguglie/Desktop/MatchApp/client/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/Users/jeguglie/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/Users/jeguglie/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/jeguglie/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/jeguglie/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/jeguglie/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/jeguglie/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/jeguglie/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/inherits\";import React from\"react\";import Warnings from\"../Warnings/Warnings\";import VALIDATE from'../../utils/validation';import API from\"../../utils/API\";import{Container,Image,Form,Button,Dimmer,Loader,Divider}from'semantic-ui-react';import{store}from'react-notifications-component';import Cookies from'universal-cookie';var cookies=new Cookies();var DEFAULT_STATE={email:\"\",password:\"\",warnings:[],loading:false,w_email:\"\",w_password:\"\"};var DEFAULT_ERRORS={w_email:\"\",w_password:\"\"};var Login=/*#__PURE__*/function(_React$Component){_inherits(Login,_React$Component);function Login(props){var _this;_classCallCheck(this,Login);_this=_possibleConstructorReturn(this,_getPrototypeOf(Login).call(this,props));_this.send=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _this$state,email,password;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:// Clear warnings\n_this.warnings=_objectSpread({},DEFAULT_ERRORS);_this$state=_this.state,email=_this$state.email,password=_this$state.password;// Check Validity\nif(_this._mounted)_this.setState({loading:true});_context2.next=5;return VALIDATE.sleepLoader(300).then(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!VALIDATE.validateEmail(email))_this.warnings.w_email=\"Please enter a valid email\";if(!VALIDATE.validatePassword(password))_this.warnings.w_password=\"Please enter a valid password\";if(VALIDATE.checkWarnings(_this.warnings)){_context.next=7;break;}_context.next=5;return API.login(email,password).then(function(response){if(typeof response.data!=='undefined'&&typeof response.data.connect!=='undefined')_this.props.handleConnected(true);window.location.href=\"/profile\";}).catch(function(error){if(typeof error.response!=='undefined'&&typeof error.response.data!=='undefined'){if(_this._mounted){_this.setState({w_email:error.response.data.w_email});if(error.response.data.w_emailconfirm)store.addNotification({title:'Account not active',message:'A confirmation link was sent to your mail',type:\"warning\",insert:\"top\",container:\"top-right\",animationIn:[\"animated\",\"fadeIn\"],animationOut:[\"animated\",\"fadeOut\"],dismiss:{duration:10000,onScreen:true}});}}});case 5:_context.next=8;break;case 7:if(_this._mounted)_this.setState(_objectSpread({},_this.warnings));case 8:case\"end\":return _context.stop();}}},_callee);})));case 5:if(_this._mounted)_this.setState({loading:false});case 6:case\"end\":return _context2.stop();}}},_callee2);}));_this.handleChange=function(event){var _this$state2=_this.state,w_email=_this$state2.w_email,w_password=_this$state2.w_password;if(event.target.id===\"email\"&&w_email&&w_email.length>0)_this.setState({w_email:\"\"});if(event.target.id===\"password\"&&w_password&&w_password.length>0)_this.setState({w_password:\"\"});_this.setState(_defineProperty({},event.target.id,event.target.value));};_this.state=_objectSpread({},DEFAULT_STATE);_this.warnings=_objectSpread({},DEFAULT_ERRORS);_this._mounted=false;return _this;}_createClass(Login,[{key:\"componentWillUnmount\",value:function componentWillUnmount(){this._mounted=false;}},{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _this2=this;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!cookies.get('token')){_context3.next=3;break;}_context3.next=3;return API.withAuth().then(function(res){if(res.status===200){_this2.props.s_userlogin();_this2.props.history.push('/profile');}}).catch(function(){return cookies.remove('token');});case 3:this._mounted=true;this.params=this.props.match.params;if(!this.params.token){_context3.next=9;break;}_context3.next=8;return API.activeaccount(this.params.token).then(function(response){if(response.status===200){store.addNotification({title:'Account validation',message:'Your account was successfully activated. You can now log in.',type:\"success\",insert:\"top\",container:\"top-right\",animationIn:[\"animated\",\"fadeIn\"],animationOut:[\"animated\",\"fadeOut\"],dismiss:{duration:10000,onScreen:true}});}else store.addNotification({title:'Error validation',message:'Token or mail are not valids.',type:\"warning\",insert:\"top\",container:\"top-right\",animationIn:[\"animated\",\"fadeIn\"],animationOut:[\"animated\",\"fadeOut\"],dismiss:{duration:10000,onScreen:true}});}).catch(function(error){store.addNotification({title:'Error validation',message:'Token or mail are not valids.',type:\"warning\",insert:\"top\",container:\"top-right\",animationIn:[\"animated\",\"fadeIn\"],animationOut:[\"animated\",\"fadeOut\"],dismiss:{duration:10000,onScreen:true}});});case 8:this.props.history.push('/login');case 9:case\"end\":return _context3.stop();}}},_callee3,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var _this3=this;var _this$state3=this.state,loading=_this$state3.loading,w_email=_this$state3.w_email,w_password=_this$state3.w_password;return React.createElement(Container,{className:\"loginModal\"},React.createElement(Dimmer,{active:loading},React.createElement(Loader,{size:\"big\"},\"Connecting to MatchApp...\")),React.createElement(Divider,{hidden:true}),React.createElement(Image,{className:\"img-fluid\",src:\"/img/MatchApp-Logo.png\",alt:\"Responsive image\",size:\"medium\",centered:true}),React.createElement(\"div\",{className:\"loginWarnings\"},React.createElement(Warnings,{data:this.state.warnings})),React.createElement(\"div\",{className:\"shape\"}),React.createElement(Divider,{hidden:true}),React.createElement(\"h1\",{className:\"loginh1\"},\"User Login\"),React.createElement(Form,{className:\"loginForm\"},React.createElement(Form.Field,null,React.createElement(Form.Input,{error:w_email&&w_email.length>0?{content:w_email,pointing:'below'}:null,id:\"email\",icon:\"users\",iconPosition:\"left\",autoFocus:true,onChange:this.handleChange,size:\"huge\",placeholder:\"Email\"})),React.createElement(Form.Field,{className:\"inputPassword\"},React.createElement(Form.Input,{error:w_password&&w_password.length>0?{content:w_password,pointing:'below'}:null,icon:\"lock\",iconPosition:\"left\",id:\"password\",onChange:this.handleChange,type:\"password\",size:\"huge\",placeholder:\"Password\"})),React.createElement(Divider,{hidden:true}),React.createElement(Button,{className:\"loginButton\",loading:loading,size:\"huge\",type:\"submit\",onClick:this.send},\"Log in\")),React.createElement(Divider,{hidden:true}),React.createElement(\"div\",{className:\"loginNoAccount\"},React.createElement(\"p\",{className:\"loginForgot\"},React.createElement(\"a\",{href:\"# \",onClick:function onClick(e){e.preventDefault();_this3.props.history.push('/forgotpassword');}},React.createElement(\"strong\",null,\"Forgot password ?\"))),React.createElement(\"p\",null,\"No account ? \",React.createElement(\"a\",{href:\"# \",onClick:function onClick(e){e.preventDefault();_this3.props.history.push('/signup');}},\"Register\"))),React.createElement(Divider,{hidden:true}));}}]);return Login;}(React.Component);export default Login;","map":{"version":3,"sources":["/Users/jeguglie/Desktop/MatchApp/client/src/components/Login/Login.js"],"names":["React","Warnings","VALIDATE","API","Container","Image","Form","Button","Dimmer","Loader","Divider","store","Cookies","cookies","DEFAULT_STATE","email","password","warnings","loading","w_email","w_password","DEFAULT_ERRORS","Login","props","send","state","_mounted","setState","sleepLoader","then","validateEmail","validatePassword","checkWarnings","login","response","data","connect","handleConnected","window","location","href","catch","error","w_emailconfirm","addNotification","title","message","type","insert","container","animationIn","animationOut","dismiss","duration","onScreen","handleChange","event","target","id","length","value","get","withAuth","res","status","s_userlogin","history","push","remove","params","match","token","activeaccount","content","pointing","e","preventDefault","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport Warnings from \"../Warnings/Warnings\";\nimport VALIDATE from '../../utils/validation';\nimport API from \"../../utils/API\";\nimport {Container, Image, Form, Button, Dimmer, Loader, Divider} from 'semantic-ui-react';\nimport { store } from 'react-notifications-component';\nimport Cookies from 'universal-cookie';\nconst cookies = new Cookies();\n\nconst DEFAULT_STATE = {\n    email: \"\",\n    password: \"\",\n    warnings: [],\n    loading: false,\n    w_email: \"\",\n    w_password: \"\",\n};\n\nconst DEFAULT_ERRORS = {\n    w_email: \"\",\n    w_password: \"\",\n};\n\nclass Login extends React.Component {\n\n    constructor (props) {\n        super(props);\n        this.state = {...DEFAULT_STATE};\n        this.warnings = {...DEFAULT_ERRORS};\n        this._mounted = false;\n    };\n\n    componentWillUnmount() {\n        this._mounted = false;\n    }\n\n    async componentDidMount() {\n        if (cookies.get('token'))\n            await API.withAuth()\n                .then(res => {\n                    if (res.status === 200) {\n                        this.props.s_userlogin();\n                        this.props.history.push('/profile');\n                    }\n                })\n                .catch(() => cookies.remove('token'));\n        this._mounted = true;\n        this.params = this.props.match.params;\n        if (this.params.token){\n            await API.activeaccount(this.params.token)\n                .then (response => {\n                    if (response.status === 200){\n                        store.addNotification({\n                            title: 'Account validation',\n                            message: 'Your account was successfully activated. You can now log in.',\n                            type: \"success\",\n                            insert: \"top\",\n                            container: \"top-right\",\n                            animationIn: [\"animated\", \"fadeIn\"],\n                            animationOut: [\"animated\", \"fadeOut\"],\n                            dismiss: {\n                                duration: 10000,\n                                onScreen: true\n                            }\n                        });\n                    }\n                    else\n                        store.addNotification({\n                            title: 'Error validation',\n                            message: 'Token or mail are not valids.',\n                            type: \"warning\",\n                            insert: \"top\",\n                            container: \"top-right\",\n                            animationIn: [\"animated\", \"fadeIn\"],\n                            animationOut: [\"animated\", \"fadeOut\"],\n                            dismiss: {\n                                duration: 10000,\n                                onScreen: true\n                            }\n                        });\n                })\n                .catch(error => {\n                    store.addNotification({\n                        title: 'Error validation',\n                        message: 'Token or mail are not valids.',\n                        type: \"warning\",\n                        insert: \"top\",\n                        container: \"top-right\",\n                        animationIn: [\"animated\", \"fadeIn\"],\n                        animationOut: [\"animated\", \"fadeOut\"],\n                        dismiss: {\n                            duration: 10000,\n                            onScreen: true\n                        }\n                    });\n                });\n            this.props.history.push('/login');\n        }\n    }\n\n    send = async() => {\n            // Clear warnings\n            this.warnings = {...DEFAULT_ERRORS};\n            const {email, password} = this.state;\n            // Check Validity\n            if (this._mounted)\n                this.setState({loading: true});\n            await VALIDATE.sleepLoader(300)\n                .then(async () => {\n                    if (!VALIDATE.validateEmail(email))\n                        this.warnings.w_email = \"Please enter a valid email\";\n                    if (!VALIDATE.validatePassword(password))\n                        this.warnings.w_password = \"Please enter a valid password\";\n                    if (!VALIDATE.checkWarnings(this.warnings)) {\n                        await API.login(email, password)\n                            .then((response) => {\n                                if (typeof response.data !== 'undefined' && typeof response.data.connect !== 'undefined')\n                                    this.props.handleConnected(true);\n                                        window.location.href = \"/profile\";\n                            })\n                            .catch(error => {\n                                if (typeof error.response !== 'undefined' && typeof error.response.data !== 'undefined') {\n                                    if (this._mounted) {\n                                        this.setState({w_email: error.response.data.w_email});\n                                        if (error.response.data.w_emailconfirm)\n                                            store.addNotification({\n                                                title: 'Account not active',\n                                                message: 'A confirmation link was sent to your mail',\n                                                type: \"warning\",\n                                                insert: \"top\",\n                                                container: \"top-right\",\n                                                animationIn: [\"animated\", \"fadeIn\"],\n                                                animationOut: [\"animated\", \"fadeOut\"],\n                                                dismiss: {\n                                                    duration: 10000,\n                                                    onScreen: true\n                                                }\n                                            });\n                                    }\n                                }\n                            });\n                    } else if (this._mounted)\n                        this.setState({...this.warnings});\n                });\n            if (this._mounted)\n                this.setState({loading: false});\n    };\n\n    handleChange = (event) => {\n        const {w_email, w_password} = this.state;\n        if (event.target.id === \"email\" && w_email && w_email.length > 0)\n            this.setState({w_email: \"\"});\n        if (event.target.id === \"password\" && w_password && w_password.length > 0)\n            this.setState({w_password: \"\"});\n        this.setState({[event.target.id]: event.target.value});\n    }\n\n\n    render() {\n        const {loading, w_email, w_password} = this.state;\n        return (\n            <Container className=\"loginModal\">\n                <Dimmer active={loading}>\n                    <Loader size='big'>Connecting to MatchApp...</Loader>\n                </Dimmer>\n                <Divider hidden />\n                     <Image className=\"img-fluid\"\n                            src=\"/img/MatchApp-Logo.png\"\n                            alt=\"Responsive image\"\n                            size=\"medium\"\n                            centered />\n                    <div className=\"loginWarnings\">\n                            <Warnings data={this.state.warnings}/>\n                    </div>\n                    <div className=\"shape\"></div>\n                    <Divider hidden />\n                    <h1 className=\"loginh1\">User Login</h1>\n                        <Form className=\"loginForm\">\n                            <Form.Field>\n                                <Form.Input\n                                       error={w_email && w_email.length > 0 ? {content: w_email, pointing: 'below'} : null}\n                                       id=\"email\"\n                                       icon='users'\n                                       iconPosition='left'\n                                       autoFocus\n                                       onChange={this.handleChange}\n                                       size=\"huge\"\n                                       placeholder=\"Email\" />\n                            </Form.Field>\n                            <Form.Field className=\"inputPassword\">\n                                <Form.Input\n                                    error={w_password && w_password.length > 0 ? {content: w_password, pointing: 'below'} : null}\n                                    icon='lock'\n                                    iconPosition='left'\n                                    id=\"password\"\n                                    onChange={this.handleChange}\n                                    type=\"password\"\n                                    size=\"huge\"\n                                    placeholder=\"Password\" />\n                            </Form.Field>\n                            <Divider hidden />\n                            <Button className=\"loginButton\"\n                                    loading={loading} size='huge'\n                                    type=\"submit\"\n                                    onClick={this.send}>\n                                Log in\n                            </Button>\n                        </Form>\n                    <Divider hidden />\n                    <div className=\"loginNoAccount\">\n                        <p className=\"loginForgot\">\n                            <a href='# ' onClick={(e) => {e.preventDefault(); this.props.history.push('/forgotpassword')}}>\n                                <strong>Forgot password ?</strong>\n                            </a>\n                        </p>\n                        <p>No account ? <a href='# ' onClick={(e) => {e.preventDefault(); this.props.history.push('/signup')}}>Register</a></p>\n                    </div>\n                <Divider hidden />\n            </Container>\n        );\n    }\n}\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}