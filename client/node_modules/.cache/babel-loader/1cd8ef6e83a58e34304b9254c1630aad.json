{"ast":null,"code":"import _objectSpread from\"/Users/jv/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/jv/Desktop/MatchApp/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jv/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/jv/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/jv/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/jv/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/jv/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/jv/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import{withRouter}from\"react-router\";import UserMiniCard from\"../../components/UserMiniCard/UserMiniCard\";import API from'./../../utils/API';import InfiniteScroll from'react-infinite-scroller';import{Button,Grid,Divider,Icon}from\"semantic-ui-react\";import ModalUser from'../../components/ModalUser/ModalUser';import{store}from\"react-notifications-component\";import Filter from'./Filter/Filter';var DEFAULT_STATE={loadingModal:'',nextUsers:'',hasMoreContent:false,clear:false,users:[],warnings:[],loading:true,userView:false,userIdFocusLoading:null,interests:[],userInterests:[],visible:false,aDescendant:false,dDescendant:false,distanceRange:250,ageRange:{min:18,max:27},popularityRange:{min:0,max:50}};var Wall=/*#__PURE__*/function(_React$Component){_inherits(Wall,_React$Component);function Wall(props){var _this;_classCallCheck(this,Wall);_this=_possibleConstructorReturn(this,_getPrototypeOf(Wall).call(this,props));_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_this._mounted=true;_this._mounted&&_this.setState({loading:true});_context2.next=4;return API.checkUserView().then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(res){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(res.status===200)){_context.next=5;break;}_context.next=3;return API.getUserInterests().then(function(response){if(response.status===200)_this._mounted&&_this.setState({interests:response.data.interests,userInterests:response.data.interests});});case 3:_this._mounted&&_this.setState({userView:true});_this.searchMatch(_this.state.distanceRange,_this.state.ageRange,_this.state.popularityRange,[]);case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}()).catch(function(){store.addNotification({message:\"Please complete your profile\",type:\"info\",insert:\"top\",container:\"top-right\",animationIn:[\"animated\",\"fadeIn\"],animationOut:[\"animated\",\"fadeOut\"],dismiss:{duration:5000,onScreen:true}});_this.props.history.push('/profile');});case 4:case\"end\":return _context2.stop();}}},_callee2);}));_this.searchMatch=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(distanceRange,ageRange,popularityRange,interests){var users,nextUsers;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_this._mounted&&_this.setState(function(prevState){return{loading:true,interests:interests&&interests.length?interests:prevState.userInterests};});users=[];_context3.next=4;return API.getUsers(distanceRange,ageRange,popularityRange,interests).then(function(response){if(response.status===200)users=response.data.users;});case 4:nextUsers=0;if(users.length>20)nextUsers=users.slice(21);_this._mounted&&_this.setState({nextUsers:nextUsers,users:users.slice(0,21),hasMoreContent:users.length>20});_this._mounted&&_this.setState({loading:false});case 8:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x2,_x3,_x4,_x5){return _ref3.apply(this,arguments);};}();_this.clickedUser=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(userIdFocus){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:// Send notification\n_this.props.sWallVisit(userIdFocus);// Inner Ref Modal\n_this.innerRefModal.current&&_this.innerRefModal.current.loadUser(userIdFocus);_this._mounted&&_this.setState({loadingMinCard:true,userIdFocusLoad:userIdFocus});case 3:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x6){return _ref4.apply(this,arguments);};}();_this.handleBottomPage=function(){var _this$state=_this.state,nextUsers=_this$state.nextUsers,users=_this$state.users;if(nextUsers.length){for(var i=0;i<nextUsers.length&&i<=20;i++){users.push(nextUsers[i]);}_this._mounted&&_this.setState({users:users,nextUsers:nextUsers.slice(21)});}else _this._mounted&&_this.setState({hasMoreContent:false});};_this.ageFilter=function(){var aDescendant=_this.state.aDescendant;_this.setState({loading:true});_this.innerRef.current&&_this.innerRef.current.ageFilter(aDescendant);_this.setState({aDescendant:!aDescendant,loading:false});};_this.distanceFilter=function(){var dDescendant=_this.state.dDescendant;_this.setState({loading:true});_this.innerRef.current&&_this.innerRef.current.distanceFilter(dDescendant);_this.setState({dDescendant:!dDescendant,loading:false});};_this.state=_objectSpread({},DEFAULT_STATE);_this._mounted=false;_this.innerRefModal=React.createRef();_this.innerRef=React.createRef();return _this;}_createClass(Wall,[{key:\"componentWillUnmount\",value:function componentWillUnmount(){this._mounted=false;}// Search button handle\n},{key:\"render\",value:function render(){var _this2=this;var _this$state2=this.state,hasMoreContent=_this$state2.hasMoreContent,loading=_this$state2.loading,users=_this$state2.users,aDescendant=_this$state2.aDescendant,interests=_this$state2.interests,dDescendant=_this$state2.dDescendant,userIdFocusLoad=_this$state2.userIdFocusLoad;var userscards=React.createElement(Grid.Column,null,React.createElement(Grid.Row,null,React.createElement(\"div\",{className:'ButtonFilters'},React.createElement(Button.Group,{size:'small',widths:3,fluid:true},React.createElement(Button,{onClick:this.ageFilter,icon:true,labelPosition:\"left\"},React.createElement(Icon,{name:aDescendant?'arrow down':'arrow up'}),\"Age\"),React.createElement(Button,{onClick:this.distanceFilter,icon:true,labelPosition:\"left\"},React.createElement(Icon,{name:dDescendant?'arrow down':'arrow up'}),\"Distance\"),React.createElement(Button,{onClick:function onClick(){return _this2.searchMatch(_this2.state.distanceRange,_this2.state.ageRange,_this2.state.popularityRange,[]);},icon:true,labelPosition:\"left\"},React.createElement(Icon,{name:\"list ol\"}),\"Match\")))),React.createElement(Divider,{hidden:true}),React.createElement(Grid,{stackable:true},!this.state.users.length&&!this.state.loading?React.createElement(\"h1\",null,\" No users found\"):null,React.createElement(UserMiniCard,{userIdFocus:userIdFocusLoad,inner:true,users:users,ref:this.innerRef,clickedUser:this.clickedUser})));return React.createElement(\"div\",{className:\"WallContainer\"},React.createElement(ModalUser,{interests:interests,s_like:this.props.s_like,s_like_unliked:this.props.s_like_unliked,s_like_likedback:this.props.s_like_likedback,ref:this.innerRefModal}),React.createElement(Grid,{centered:true,columns:'equal',stackable:true},React.createElement(Filter,{loading:loading,searchMatch:this.searchMatch}),userscards),React.createElement(InfiniteScroll,{pageStart:0,loadMore:this.handleBottomPage,hasMore:hasMoreContent},\" \"));}}]);return Wall;}(React.Component);export default withRouter(Wall);","map":{"version":3,"sources":["/Users/jv/Desktop/MatchApp/client/src/containers/Wall/Wall.js"],"names":["React","withRouter","UserMiniCard","API","InfiniteScroll","Button","Grid","Divider","Icon","ModalUser","store","Filter","DEFAULT_STATE","loadingModal","nextUsers","hasMoreContent","clear","users","warnings","loading","userView","userIdFocusLoading","interests","userInterests","visible","aDescendant","dDescendant","distanceRange","ageRange","min","max","popularityRange","Wall","props","componentDidMount","_mounted","setState","checkUserView","then","res","status","getUserInterests","response","data","searchMatch","state","catch","addNotification","message","type","insert","container","animationIn","animationOut","dismiss","duration","onScreen","history","push","prevState","length","getUsers","slice","clickedUser","userIdFocus","sWallVisit","innerRefModal","current","loadUser","loadingMinCard","userIdFocusLoad","handleBottomPage","i","ageFilter","innerRef","distanceFilter","createRef","userscards","s_like","s_like_unliked","s_like_likedback","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { withRouter } from \"react-router\";\nimport UserMiniCard from \"../../components/UserMiniCard/UserMiniCard\";\nimport API from './../../utils/API';\nimport InfiniteScroll from 'react-infinite-scroller';\nimport { Button, Grid, Divider, Icon } from \"semantic-ui-react\";\nimport ModalUser from '../../components/ModalUser/ModalUser';\nimport { store } from \"react-notifications-component\";\nimport Filter from './Filter/Filter';\n\nconst DEFAULT_STATE = {\n    loadingModal: '',\n    nextUsers: '',\n    hasMoreContent: false,\n    clear: false,\n    users: [],\n    warnings: [],\n    loading: true,\n    userView: false,\n    userIdFocusLoading: null,\n    interests: [],\n    userInterests: [],\n    visible: false,\n    aDescendant: false,\n    dDescendant: false,\n    distanceRange: 250,\n    ageRange: {\n        min: 18,\n        max: 27,\n    },\n    popularityRange: {\n        min: 0,\n        max: 50,\n    },\n\n};\nclass Wall extends React.Component {\n\n    constructor(props){\n        super(props);\n        this.state = {...DEFAULT_STATE};\n        this._mounted = false;\n        this.innerRefModal = React.createRef();\n        this.innerRef = React.createRef();\n    }\n\n    componentDidMount = async() => {\n        this._mounted = true;\n        this._mounted && this.setState({loading: true});\n        await API.checkUserView()\n            .then(async(res) => {\n                if (res.status === 200) {\n                    await API.getUserInterests()\n                        .then(response => {\n                            if (response.status === 200)\n                                this._mounted && this.setState({interests: response.data.interests, userInterests: response.data.interests})\n                        });\n                    this._mounted && this.setState({userView: true});\n                    this.searchMatch(this.state.distanceRange, this.state.ageRange, this.state.popularityRange, []);\n                }\n            })\n            .catch( () => {\n                store.addNotification({\n                    message: \"Please complete your profile\",\n                    type: \"info\",\n                    insert: \"top\",\n                    container: \"top-right\",\n                    animationIn: [\"animated\", \"fadeIn\"],\n                    animationOut: [\"animated\", \"fadeOut\"],\n                    dismiss: {\n                        duration: 5000,\n                        onScreen: true\n                    }\n                });\n                this.props.history.push('/profile');\n            });\n    };\n\n    componentWillUnmount() {\n        this._mounted = false;\n    }\n\n    // Search button handle\n    searchMatch = async(distanceRange, ageRange, popularityRange, interests) => {\n        this._mounted && this.setState(prevState => ({loading: true, interests: interests && interests.length ? interests : prevState.userInterests}));\n        let users = [];\n        await API.getUsers(distanceRange, ageRange, popularityRange, interests)\n            .then(response => {\n                if (response.status === 200)\n                    users = response.data.users;\n            });\n        let nextUsers = 0;\n        if(users.length > 20)\n           nextUsers = users.slice(21);\n        this._mounted && this.setState({\n            nextUsers: nextUsers,\n            users: users.slice(0, 21),\n            hasMoreContent: users.length > 20\n        });\n        this._mounted && this.setState({loading: false});\n\n    };\n\n\n    clickedUser = async(userIdFocus) => {\n        // Send notification\n        this.props.sWallVisit(userIdFocus);\n        // Inner Ref Modal\n        this.innerRefModal.current && this.innerRefModal.current.loadUser(userIdFocus);\n        this._mounted && this.setState({ loadingMinCard: true, userIdFocusLoad: userIdFocus});\n    };\n    handleBottomPage = () => {\n        const { nextUsers, users } = this.state;\n        if (nextUsers.length){\n            for (let i = 0; i < nextUsers.length && i <= 20; i++)\n                users.push(nextUsers[i]);\n            this._mounted && this.setState({users: users, nextUsers: nextUsers.slice(21)});\n        }\n        else\n            this._mounted && this.setState({hasMoreContent: false});\n    };\n    // Filters\n    ageFilter = () => {\n        const {aDescendant } = this.state;\n        this.setState({loading: true});\n        this.innerRef.current && this.innerRef.current.ageFilter(aDescendant);\n        this.setState({aDescendant: !aDescendant, loading: false});\n    };\n\n    distanceFilter = () => {\n        const {dDescendant } = this.state;\n        this.setState({loading: true});\n        this.innerRef.current && this.innerRef.current.distanceFilter(dDescendant);\n        this.setState({dDescendant: !dDescendant, loading: false});\n    };\n\n    render() {\n        const { hasMoreContent, loading, users, aDescendant, interests, dDescendant, userIdFocusLoad} = this.state;\n        const userscards = (\n            <Grid.Column>\n                <Grid.Row>\n                    <div className={'ButtonFilters'}>\n                        <Button.Group size={'small'} widths={3} fluid>\n                            <Button\n                                onClick={this.ageFilter}\n                                icon\n                                labelPosition='left'>\n                                <Icon name={aDescendant ? 'arrow down' : 'arrow up'}/>Age</Button>\n                            <Button\n                                onClick={this.distanceFilter}\n                                icon\n                                labelPosition='left'>\n                                <Icon name={dDescendant ? 'arrow down' : 'arrow up'} />\n                                Distance\n                            </Button>\n                            <Button\n                                onClick={() => this.searchMatch(this.state.distanceRange, this.state.ageRange, this.state.popularityRange, [])}\n                                icon\n                                labelPosition='left'>\n                                <Icon name='list ol' />\n                                Match\n                            </Button>\n                        </Button.Group>\n                    </div>\n                </Grid.Row>\n                <Divider hidden/>\n                <Grid stackable >\n                    {!this.state.users.length && !this.state.loading ? <h1> No users found</h1> : null}\n                    <UserMiniCard\n                        userIdFocus={userIdFocusLoad}\n                        inner\n                        users={users}\n                        ref={this.innerRef}\n                        clickedUser={this.clickedUser}\n                    />\n                </Grid>\n            </Grid.Column>\n        );\n\n        return (\n            <div className=\"WallContainer\">\n                <ModalUser interests={interests} s_like={this.props.s_like} s_like_unliked={this.props.s_like_unliked} s_like_likedback={this.props.s_like_likedback} ref={this.innerRefModal} />\n                <Grid centered columns={'equal'} stackable>\n                    <Filter loading={loading} searchMatch={this.searchMatch} />\n                    {userscards}\n                </Grid>\n                <InfiniteScroll\n                    pageStart={0}\n                    loadMore={this.handleBottomPage}\n                    hasMore={hasMoreContent}\n                > </InfiniteScroll>\n            </div>\n        );\n    }\n}\n\nexport default withRouter(Wall);"]},"metadata":{},"sourceType":"module"}