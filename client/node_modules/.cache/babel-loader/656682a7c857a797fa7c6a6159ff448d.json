{"ast":null,"code":"var _jsxFileName = \"/Users/jv/Desktop/MatchApp/client/src/containers/Wall/Wall.js\";\nimport React from 'react';\nimport { withRouter } from \"react-router\";\nimport UserMiniCard from \"../../components/UserMiniCard/UserMiniCard\";\nimport API from './../../utils/API';\nimport InfiniteScroll from 'react-infinite-scroller';\nimport { Button, Grid, Divider, Icon } from \"semantic-ui-react\";\nimport 'react-input-range/lib/css/index.css';\nimport ModalUser from '../../components/ModalUser/ModalUser';\nimport { store } from \"react-notifications-component\";\nimport Filter from './Filter/Filter';\nconst DEFAULT_STATE = {\n  loadingModal: '',\n  nextUsers: '',\n  hasMoreContent: false,\n  clear: false,\n  users: [],\n  warnings: [],\n  loading: true,\n  userView: false,\n  userIdFocusLoading: null,\n  interests: [],\n  visible: false,\n  aDescendant: false,\n  dDescendant: false,\n  distanceRange: 250,\n  ageRange: {\n    min: 18,\n    max: 27\n  },\n  popularityRange: {\n    min: 0,\n    max: 50\n  }\n};\n\nclass Wall extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = async () => {\n      this._mounted = true;\n      this._mounted && this.setState({\n        loading: true\n      });\n      await API.checkUserView().then(res => {\n        if (res.status === 200) {\n          this._mounted && this.setState({\n            userView: true\n          });\n          this.searchMatch(this.state.distanceRange, this.state.ageRange, this.state.popularityRange);\n        }\n      }).catch(() => {\n        store.addNotification({\n          message: \"Please complete your profile\",\n          type: \"info\",\n          insert: \"top\",\n          container: \"top-right\",\n          animationIn: [\"animated\", \"fadeIn\"],\n          animationOut: [\"animated\", \"fadeOut\"],\n          dismiss: {\n            duration: 5000,\n            onScreen: true\n          }\n        });\n        this.props.history.push('/profile');\n      });\n    };\n\n    this.searchMatch = async (distanceRange, ageRange, popularityRange) => {\n      this._mounted && this.setState({\n        loading: true\n      });\n      let users = [];\n      await API.getUsers(distanceRange, ageRange, popularityRange).then(response => {\n        if (response.status === 200) users = response.data.users;\n      });\n      let nextUsers = 0;\n      if (users.length > 20) nextUsers = users.slice(21);\n      this._mounted && this.setState({\n        nextUsers: nextUsers,\n        users: users.slice(0, 21),\n        hasMoreContent: users.length > 20\n      });\n      this._mounted && this.setState({\n        loading: false\n      });\n    };\n\n    this.clickedUser = async userIdFocus => {\n      // Send notification\n      this.props.sWallVisit(userIdFocus); // Inner Ref Modal\n\n      this.innerRefModal.current && this.innerRefModal.current.loadUser(userIdFocus);\n      this._mounted && this.setState({\n        loadingMinCard: true,\n        userIdFocusLoad: userIdFocus\n      });\n    };\n\n    this.handleBottomPage = () => {\n      const {\n        nextUsers,\n        users\n      } = this.state;\n\n      if (nextUsers.length) {\n        for (let i = 0; i < nextUsers.length && i <= 20; i++) users.push(nextUsers[i]);\n\n        this._mounted && this.setState({\n          users: users,\n          nextUsers: nextUsers.slice(21)\n        });\n      } else this._mounted && this.setState({\n        hasMoreContent: false\n      });\n    };\n\n    this.ageFilter = () => {\n      const {\n        aDescendant\n      } = this.state;\n      this.innerRef.current && this.innerRef.current.ageFilter(aDescendant);\n      this.setState({\n        aDescendant: !aDescendant\n      });\n    };\n\n    this.distanceFilter = () => {\n      const {\n        dDescendant\n      } = this.state;\n      this.innerRef.current && this.innerRef.current.distanceFilter(dDescendant);\n      this.setState({\n        dDescendant: !dDescendant\n      });\n    };\n\n    this.state = { ...DEFAULT_STATE\n    };\n    this._mounted = false;\n    this.innerRefModal = React.createRef();\n    this.innerRef = React.createRef();\n  }\n\n  componentWillUnmount() {\n    this._mounted = false;\n  } // Search button handle\n\n\n  render() {\n    const {\n      hasMoreContent,\n      users,\n      aDescendant,\n      dDescendant,\n      userIdFocusLoad\n    } = this.state;\n    const userscards = React.createElement(Grid.Column, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }, React.createElement(Grid.Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: 'ButtonFilters',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }, React.createElement(Button.Group, {\n      size: 'small',\n      widths: 3,\n      fluid: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }, React.createElement(Button, {\n      onClick: this.ageFilter,\n      icon: true,\n      labelPosition: \"left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: aDescendant ? 'arrow down' : 'arrow up',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }), \"Age\"), React.createElement(Button, {\n      onClick: this.distanceFilter,\n      icon: true,\n      labelPosition: \"left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: dDescendant ? 'arrow down' : 'arrow up',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }), \"Distance\"), React.createElement(Button, {\n      onClick: this.searchMatch,\n      icon: true,\n      labelPosition: \"left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      name: \"list ol\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }), \"Match\")))), React.createElement(Divider, {\n      hidden: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }), React.createElement(Grid, {\n      stackable: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159\n      },\n      __self: this\n    }, React.createElement(UserMiniCard, {\n      userIdFocus: userIdFocusLoad,\n      inner: true,\n      users: users,\n      ref: this.innerRef,\n      clickedUser: this.clickedUser,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    })));\n    return React.createElement(\"div\", {\n      className: \"WallContainer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, React.createElement(ModalUser, {\n      s_like: this.props.s_like,\n      s_like_unliked: this.props.s_like_unliked,\n      s_like_likedback: this.props.s_like_likedback,\n      ref: this.innerRefModal,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }), React.createElement(Grid, {\n      centered: true,\n      columns: 'equal',\n      stackable: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, React.createElement(Filter, {\n      searchMatch: this.searchMatch(this.state.distanceRange, this.state.ageRange, this.state.popularityRange),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }), userscards), React.createElement(InfiniteScroll, {\n      pageStart: 0,\n      loadMore: this.handleBottomPage,\n      hasMore: hasMoreContent,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }, \" \"));\n  }\n\n}\n\nexport default withRouter(Wall);","map":{"version":3,"sources":["/Users/jv/Desktop/MatchApp/client/src/containers/Wall/Wall.js"],"names":["React","withRouter","UserMiniCard","API","InfiniteScroll","Button","Grid","Divider","Icon","ModalUser","store","Filter","DEFAULT_STATE","loadingModal","nextUsers","hasMoreContent","clear","users","warnings","loading","userView","userIdFocusLoading","interests","visible","aDescendant","dDescendant","distanceRange","ageRange","min","max","popularityRange","Wall","Component","constructor","props","componentDidMount","_mounted","setState","checkUserView","then","res","status","searchMatch","state","catch","addNotification","message","type","insert","container","animationIn","animationOut","dismiss","duration","onScreen","history","push","getUsers","response","data","length","slice","clickedUser","userIdFocus","sWallVisit","innerRefModal","current","loadUser","loadingMinCard","userIdFocusLoad","handleBottomPage","i","ageFilter","innerRef","distanceFilter","createRef","componentWillUnmount","render","userscards","s_like","s_like_unliked","s_like_likedback"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { withRouter } from \"react-router\";\nimport UserMiniCard from \"../../components/UserMiniCard/UserMiniCard\";\nimport API from './../../utils/API';\nimport InfiniteScroll from 'react-infinite-scroller';\nimport { Button, Grid, Divider, Icon } from \"semantic-ui-react\";\nimport 'react-input-range/lib/css/index.css';\nimport ModalUser from '../../components/ModalUser/ModalUser';\nimport { store } from \"react-notifications-component\";\nimport Filter from './Filter/Filter';\n\nconst DEFAULT_STATE = {\n    loadingModal: '',\n    nextUsers: '',\n    hasMoreContent: false,\n    clear: false,\n    users: [],\n    warnings: [],\n    loading: true,\n    userView: false,\n    userIdFocusLoading: null,\n    interests: [],\n    visible: false,\n    aDescendant: false,\n    dDescendant: false,\n    distanceRange: 250,\n    ageRange: {\n        min: 18,\n        max: 27,\n    },\n    popularityRange: {\n        min: 0,\n        max: 50,\n    },\n};\nclass Wall extends React.Component {\n\n    constructor(props){\n        super(props);\n        this.state = {...DEFAULT_STATE};\n        this._mounted = false;\n        this.innerRefModal = React.createRef();\n        this.innerRef = React.createRef();\n    }\n\n    componentDidMount = async() => {\n        this._mounted = true;\n        this._mounted && this.setState({loading: true});\n        await API.checkUserView()\n            .then(res => {\n                if (res.status === 200) {\n                    this._mounted && this.setState({userView: true});\n                    this.searchMatch(this.state.distanceRange, this.state.ageRange, this.state.popularityRange);\n                }\n            })\n            .catch( () => {\n                store.addNotification({\n                    message: \"Please complete your profile\",\n                    type: \"info\",\n                    insert: \"top\",\n                    container: \"top-right\",\n                    animationIn: [\"animated\", \"fadeIn\"],\n                    animationOut: [\"animated\", \"fadeOut\"],\n                    dismiss: {\n                        duration: 5000,\n                        onScreen: true\n                    }\n                });\n                this.props.history.push('/profile');\n            });\n    };\n\n    componentWillUnmount() {\n        this._mounted = false;\n    }\n\n    // Search button handle\n    searchMatch = async(distanceRange, ageRange, popularityRange) => {\n        this._mounted && this.setState({loading: true})\n        let users = [];\n        await API.getUsers(distanceRange, ageRange, popularityRange)\n            .then(response => {\n                if (response.status === 200)\n                    users = response.data.users;\n            });\n        let nextUsers = 0;\n        if(users.length > 20)\n           nextUsers = users.slice(21);\n        this._mounted && this.setState({\n            nextUsers: nextUsers,\n            users: users.slice(0, 21),\n            hasMoreContent: users.length > 20\n        });\n        this._mounted && this.setState({loading: false});\n\n    };\n\n\n    clickedUser = async(userIdFocus) => {\n        // Send notification\n        this.props.sWallVisit(userIdFocus);\n        // Inner Ref Modal\n        this.innerRefModal.current && this.innerRefModal.current.loadUser(userIdFocus);\n        this._mounted && this.setState({ loadingMinCard: true, userIdFocusLoad: userIdFocus});\n    };\n    handleBottomPage = () => {\n        const { nextUsers, users } = this.state;\n        if (nextUsers.length){\n            for (let i = 0; i < nextUsers.length && i <= 20; i++)\n                users.push(nextUsers[i]);\n            this._mounted && this.setState({users: users, nextUsers: nextUsers.slice(21)});\n        }\n        else\n            this._mounted && this.setState({hasMoreContent: false});\n    };\n    // Filters\n    ageFilter = () => {\n        const {aDescendant } = this.state;\n        this.innerRef.current && this.innerRef.current.ageFilter(aDescendant);\n        this.setState({aDescendant: !aDescendant});\n    };\n\n    distanceFilter = () => {\n        const {dDescendant } = this.state;\n        this.innerRef.current && this.innerRef.current.distanceFilter(dDescendant);\n        this.setState({dDescendant: !dDescendant});\n    };\n\n    render() {\n        const { hasMoreContent, users, aDescendant, dDescendant, userIdFocusLoad} = this.state;\n        const userscards = (\n            <Grid.Column>\n                <Grid.Row>\n                    <div className={'ButtonFilters'}>\n                        <Button.Group size={'small'} widths={3} fluid>\n                            <Button\n                                onClick={this.ageFilter}\n                                icon\n                                labelPosition='left'>\n                                <Icon name={aDescendant ? 'arrow down' : 'arrow up'}/>Age</Button>\n                            <Button\n                                onClick={this.distanceFilter}\n                                icon\n                                labelPosition='left'>\n                                <Icon name={dDescendant ? 'arrow down' : 'arrow up'} />\n                                Distance\n                            </Button>\n                            <Button\n                                onClick={this.searchMatch}\n                                icon\n                                labelPosition='left'>\n                                <Icon name='list ol' />\n                                Match\n                            </Button>\n                        </Button.Group>\n                    </div>\n                </Grid.Row>\n                <Divider hidden/>\n                <Grid stackable >\n                    <UserMiniCard\n                        userIdFocus={userIdFocusLoad}\n                        inner\n                        users={users}\n                        ref={this.innerRef}\n                        clickedUser={this.clickedUser}\n                    />\n                </Grid>\n            </Grid.Column>\n        );\n\n        return (\n            <div className=\"WallContainer\">\n                <ModalUser s_like={this.props.s_like} s_like_unliked={this.props.s_like_unliked} s_like_likedback={this.props.s_like_likedback} ref={this.innerRefModal} />\n                <Grid centered columns={'equal'} stackable>\n                    <Filter searchMatch={this.searchMatch(this.state.distanceRange, this.state.ageRange, this.state.popularityRange)} />\n                    {userscards}\n                </Grid>\n                <InfiniteScroll\n                    pageStart={0}\n                    loadMore={this.handleBottomPage}\n                    hasMore={hasMoreContent}\n                > </InfiniteScroll>\n            </div>\n        );\n    }\n}\n\nexport default withRouter(Wall);"]},"metadata":{},"sourceType":"module"}