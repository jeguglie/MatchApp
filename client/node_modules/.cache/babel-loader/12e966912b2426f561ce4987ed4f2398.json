{"ast":null,"code":"import _regeneratorRuntime from\"/Users/jv/Desktop/MatchApp/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/jv/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectWithoutProperties from\"/Users/jv/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";import _classCallCheck from\"/Users/jv/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/jv/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/jv/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/jv/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/jv/Desktop/MatchApp/client/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import{ButtonToolbar,Navbar,Button,Nav,ButtonGroup,NavDropdown}from'react-bootstrap';import'../../Assets/global-styles/bootstrap-iso.css';import{Icon}from\"semantic-ui-react\";import classnames from'classnames';import{withRouter}from'react-router';import Aux from\"../../hoc/Aux\";import API from'../../utils/API';import Cookies from'universal-cookie';var cookies=new Cookies();var withRouterAndRef=function withRouterAndRef(WrappedComponent){var InnerComponentWithRef=/*#__PURE__*/function(_React$Component){_inherits(InnerComponentWithRef,_React$Component);function InnerComponentWithRef(){_classCallCheck(this,InnerComponentWithRef);return _possibleConstructorReturn(this,_getPrototypeOf(InnerComponentWithRef).apply(this,arguments));}_createClass(InnerComponentWithRef,[{key:\"render\",value:function render(){var _this$props=this.props,forwardRef=_this$props.forwardRef,rest=_objectWithoutProperties(_this$props,[\"forwardRef\"]);return React.createElement(WrappedComponent,Object.assign({},rest,{ref:forwardRef}));}}]);return InnerComponentWithRef;}(React.Component);var ComponentWithRouter=withRouter(InnerComponentWithRef,{withRef:true});return React.forwardRef(function(props,ref){return React.createElement(ComponentWithRouter,Object.assign({},props,{forwardRef:ref}));});};var NavbarBootstrap=/*#__PURE__*/function(_React$Component2){_inherits(NavbarBootstrap,_React$Component2);function NavbarBootstrap(props){var _this;_classCallCheck(this,NavbarBootstrap);_this=_possibleConstructorReturn(this,_getPrototypeOf(NavbarBootstrap).call(this,props));_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_this._mounted=true;if(!cookies.get('token')){_context2.next=4;break;}_context2.next=4;return API.withAuth().then(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(res){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(res.status===200)_this.setState({connected:true});_context.next=3;return API.getNotifNb().then(function(res){if(res.status===200)_this._mounted&&_this.setState({notifNb:res.data.notifNb});});case 3:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}());case 4:_this._mounted&&_this.setState({activeItem:_this.props.location.pathname});case 5:case\"end\":return _context2.stop();}}},_callee2);}));_this.updateNotifNb=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return API.getNotifNb().then(function(res){if(res.status===200)_this._mounted&&_this.setState({notifNb:res.data.notifNb});});case 2:case\"end\":return _context3.stop();}}},_callee3);}));_this.handleConnected=function(bool){_this.setState({connected:bool});};_this.handleItemClick=function(e,redirect){_this.setState({activeItem:redirect},function(){return _this.redirect(redirect);});};_this.redirect=function(redirect){_this.props.history.push(redirect);};_this.disconnect=function(){API.logout().then(function(res){if(res.status===200){_this._mounted&&_this.setState({connected:false});_this.props.history.push('/login');_this.props.logout();}});};_this.isConnected=function(){var activeItem=_this.state.activeItem;if(_this.state.connected===false)return React.createElement(Aux,null,React.createElement(ButtonGroup,null,React.createElement(Button,{className:activeItem==='/login'?classnames(\"activeItemButton\"):null,size:\"md\",id:\"loginButton\",variant:\"outline-primary\",onClick:function onClick(){return _this.handleItemClick(null,\"/login\");}},\"Log in\"),React.createElement(Button,{className:activeItem==='/signup'?classnames(\"activeItemButton\",\"mr-3\"):\"mr-3\",id:\"signupButton\",variant:\"outline-primary\",onClick:function onClick(){return _this.handleItemClick(null,\"/signup\");}},\"Sign up\")));else{return React.createElement(\"div\",null,React.createElement(ButtonToolbar,{className:\"mr-3\"},React.createElement(Button,{size:\"md\",variant:\"outline-primary\",onClick:_this.disconnect},\"Log out\")));}};_this.showMenu=function(){var _this$state=_this.state,activeItem=_this$state.activeItem,notifNb=_this$state.notifNb,connected=_this$state.connected;var navDropdownTitle=React.createElement(Aux,null,React.createElement(Icon,{size:\"large\",name:\"user\"}),React.createElement(\"span\",{className:\"itemMenu\"},\"Profile\"));if(connected===true)return React.createElement(Nav,{className:\"mr-auto\"},React.createElement(Nav.Link,{className:activeItem==='/'?\"activeItem\":null,onClick:function onClick(){return _this.handleItemClick(null,\"/\");}},React.createElement(Icon,{size:\"large\",name:\"gratipay\"}),React.createElement(\"span\",{className:\"itemMenu\"},\"Wall\")),React.createElement(NavDropdown,{title:navDropdownTitle,className:activeItem==='/profile'?\"activeItem\":null},React.createElement(NavDropdown.Item,{onClick:function onClick(){return _this.handleItemClick(null,\"/profile\");}},\"Edit my profile\"),React.createElement(NavDropdown.Divider,null),React.createElement(NavDropdown.Item,{onClick:function onClick(){return _this.handleItemClick(null,\"/changepassword\");}},\"Edit my password\"),React.createElement(NavDropdown.Item,{onClick:function onClick(){return _this.handleItemClick(null,\"/changemail\");}},\"Edit my mail\")),React.createElement(Nav.Link,{className:activeItem==='/chat'?\"activeItem\":null,redirect:\"chat\",onClick:function onClick(){return _this.handleItemClick(null,\"/chat\");}},React.createElement(Icon,{size:\"large\",name:\"conversation\"}),React.createElement(\"span\",{className:\"itemMenu\"},\"Messages\")),React.createElement(Nav.Link,{className:activeItem==='/notifications'?\"activeItem\":null,id:\"/notifications\",onClick:function onClick(){return _this.handleItemClick(null,\"/notifications\");}},React.createElement(Icon,{size:\"large\",name:\"bell\"}),React.createElement(\"div\",{className:\"badgecontainernotif\"},React.createElement(\"span\",{className:\"itemMenu\"},\"Notifications\"),notifNb>0?React.createElement(\"span\",{className:\"badgenotif\"},notifNb):null)));else return null;};_this.state={activeItem:'',redirect:'',connected:false,notifNb:0};_this._mounted=false;return _this;}_createClass(NavbarBootstrap,[{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps,prevState,snapshot){var _this2=this;if(prevProps.isConnected!==this.props.isConnected&&this.props.isConnected===true){API.getNotifNb().then(function(res){if(res.status===200)_this2._mounted&&_this2.setState({notifNb:res.data.notifNb,connected:true});});}}},{key:\"render\",value:function render(){return React.createElement(\"div\",{className:\"bootstrap-iso\"},React.createElement(\"div\",{className:\"Menu\"},React.createElement(Navbar,{sticky:\"top\",collapseOnSelect:true,expand:\"sm\"},React.createElement(Navbar.Brand,{className:\"ml-3\",id:\"/\"},React.createElement(\"img\",{src:\"./../../img/MatchApp-Logo.png\",height:\"50\",alt:\"MatchApp Logo\"})),React.createElement(Navbar.Toggle,null),React.createElement(Navbar.Collapse,null,this.showMenu(),React.createElement(Nav,null,React.createElement(\"div\",{className:\"ConnectionNav m-1\"},this.isConnected()))))));}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(nextProps,prevState){if(nextProps.location.pathname!==prevState.activeItem)return{activeItem:nextProps.location.pathname};if(nextProps.isConnected!==prevState.isConnected&&nextProps.isConnected===true){API.getNotifNb().then(function(res){if(res.status===200)return{notifNb:res.data.notifNb,connected:true};});}return null;}}]);return NavbarBootstrap;}(React.Component);export default withRouterAndRef(NavbarBootstrap);","map":{"version":3,"sources":["/Users/jv/Desktop/MatchApp/client/src/components/Menu/BootstrapMenu.js"],"names":["React","ButtonToolbar","Navbar","Button","Nav","ButtonGroup","NavDropdown","Icon","classnames","withRouter","Aux","API","Cookies","cookies","withRouterAndRef","WrappedComponent","InnerComponentWithRef","props","forwardRef","rest","Component","ComponentWithRouter","withRef","ref","NavbarBootstrap","componentDidMount","_mounted","get","withAuth","then","res","status","setState","connected","getNotifNb","notifNb","data","activeItem","location","pathname","updateNotifNb","handleConnected","bool","handleItemClick","e","redirect","history","push","disconnect","logout","isConnected","state","showMenu","navDropdownTitle","prevProps","prevState","snapshot","nextProps"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { ButtonToolbar, Navbar, Button, Nav, ButtonGroup, NavDropdown} from 'react-bootstrap';\nimport '../../Assets/global-styles/bootstrap-iso.css';\nimport { Icon } from \"semantic-ui-react\";\nimport classnames from 'classnames';\nimport { withRouter } from 'react-router';\nimport Aux from \"../../hoc/Aux\";\nimport API from '../../utils/API';\nimport Cookies from 'universal-cookie';\nconst cookies = new Cookies();\n\nconst withRouterAndRef = (WrappedComponent) => {\n    class InnerComponentWithRef extends React.Component {\n        render() {\n            const { forwardRef, ...rest } = this.props;\n            return <WrappedComponent {...rest} ref={forwardRef} />;\n        }\n    }\n    const ComponentWithRouter = withRouter(InnerComponentWithRef, { withRef: true });\n    return React.forwardRef((props, ref) => {\n        return <ComponentWithRouter {...props} forwardRef={ref} />;\n    });\n}\n\n\nclass NavbarBootstrap extends React.Component {\n\n    constructor(props){\n        super(props);\n        this.state = {\n            activeItem: '',\n            redirect: '',\n            connected: false,\n            notifNb: 0,\n        };\n        this._mounted = false;\n    }\n\n    componentDidMount = async() => {\n        this._mounted = true;\n        if (cookies.get('token'))\n            await API.withAuth()\n                .then(async(res) => {\n                    if (res.status === 200)\n                        this.setState({connected: true});\n                    await API.getNotifNb()\n                        .then(res => {\n                            if (res.status === 200)\n                                this._mounted && this.setState({notifNb: res.data.notifNb})\n                        });\n                });\n        this._mounted && this.setState({activeItem: this.props.location.pathname});\n    };\n\n    updateNotifNb = async() => {\n        await API.getNotifNb()\n            .then(res => {\n                if (res.status === 200)\n                    this._mounted && this.setState({notifNb: res.data.notifNb})\n            });\n    };\n    handleConnected = (bool) => {this.setState({connected: bool})};\n\n    componentDidUpdate(prevProps, prevState, snapshot) {\n        if (prevProps.isConnected !== this.props.isConnected && this.props.isConnected === true){\n            API.getNotifNb()\n                .then(res => {\n                    if (res.status === 200)\n                        this._mounted && this.setState({notifNb: res.data.notifNb, connected: true})\n                });\n        }\n    }\n\n    static getDerivedStateFromProps(nextProps, prevState){\n        if(nextProps.location.pathname !== prevState.activeItem)\n           return{activeItem: nextProps.location.pathname};\n        if (nextProps.isConnected !== prevState.isConnected && nextProps.isConnected === true){\n            API.getNotifNb()\n                .then(res => {\n                    if (res.status === 200)\n                       return({notifNb: res.data.notifNb, connected: true});\n                });\n        }\n        return null;\n    }\n\n    handleItemClick = (e, redirect) => { this.setState({ activeItem: redirect}, () => this.redirect(redirect)) };\n    redirect = (redirect) => { this.props.history.push(redirect) };\n    disconnect = () => {\n        API.logout()\n            .then(res => {\n                if (res.status === 200) {\n                    this._mounted && this.setState({connected: false});\n                    this.props.history.push('/login');\n                    this.props.logout();\n                }\n            });\n    };\n\n    isConnected = () => {\n        const { activeItem } = this.state;\n        if (this.state.connected === false)\n            return (\n                <Aux>\n                    <ButtonGroup>\n                        <Button\n                            className={activeItem === '/login' ? classnames(\"activeItemButton\") : null}\n                            size=\"md\"\n                            id=\"loginButton\"\n                            variant=\"outline-primary\"\n                            onClick={() => this.handleItemClick(null, \"/login\")}>Log in</Button>\n                        <Button\n                            className={activeItem === '/signup' ? classnames(\"activeItemButton\", \"mr-3\") : \"mr-3\"}\n                            id=\"signupButton\"\n                            variant=\"outline-primary\"\n                            onClick={() => this.handleItemClick(null, \"/signup\")}>Sign up</Button>\n                    </ButtonGroup>\n                </Aux>\n            );\n        else {\n            return (\n                <div>\n                    <ButtonToolbar className='mr-3'>\n                            <Button\n                                size=\"md\"\n                                variant=\"outline-primary\"\n                                onClick={this.disconnect}>Log out</Button>\n                    </ButtonToolbar>\n                </div>\n            )\n        }\n    };\n\n\n\n    showMenu = () => {\n        const { activeItem, notifNb, connected } = this.state;\n        const navDropdownTitle = (\n            <Aux>\n                <Icon size='large' name='user'/>\n                <span className=\"itemMenu\">Profile</span>\n            </Aux>\n        );\n        if (connected === true)\n            return (\n                <Nav className='mr-auto'>\n                    <Nav.Link\n                        className={activeItem === '/' ? \"activeItem\" : null}\n                        onClick={() => this.handleItemClick(null, \"/\")}>\n                        <Icon size='large' name='gratipay' />\n                        <span className=\"itemMenu\">Wall</span>\n                    </Nav.Link>\n                    <NavDropdown\n                        title={navDropdownTitle}\n                        className={activeItem === '/profile' ? \"activeItem\" : null}>\n                        <NavDropdown.Item\n                            onClick={() => this.handleItemClick(null, \"/profile\")}>\n                            Edit my profile\n                        </NavDropdown.Item>\n                        <NavDropdown.Divider />\n                        <NavDropdown.Item\n                            onClick={() => this.handleItemClick(null, \"/changepassword\")}>\n                            Edit my password\n                        </NavDropdown.Item>\n                        <NavDropdown.Item\n                            onClick={() => this.handleItemClick(null, \"/changemail\")}>\n                            Edit my mail\n                        </NavDropdown.Item>\n\n                    </NavDropdown>\n                    <Nav.Link\n                        className={activeItem === '/chat' ? \"activeItem\" : null}\n                        redirect='chat'\n                        onClick={() => this.handleItemClick(null, \"/chat\")}>\n                        <Icon size='large' name='conversation' />\n                        <span className=\"itemMenu\">Messages</span>\n                    </Nav.Link>\n                    <Nav.Link\n                        className={activeItem === '/notifications' ? \"activeItem\" : null}\n                        id='/notifications'\n                        onClick={() => this.handleItemClick(null, \"/notifications\")}>\n                        <Icon size='large' name='bell' />\n                        <div className=\"badgecontainernotif\">\n                            <span className=\"itemMenu\">Notifications</span>\n                            {notifNb > 0 ? <span className=\"badgenotif\">{notifNb}</span> : null}\n                        </div>\n                    </Nav.Link>\n                </Nav>\n            )\n        else\n            return null;\n    }\n    render() {\n        return (\n            <div className='bootstrap-iso'>\n                <div className=\"Menu\">\n                    <Navbar sticky=\"top\" collapseOnSelect expand=\"sm\">\n                        <Navbar.Brand\n                            className=\"ml-3\"\n                            id='/'>\n                            <img\n                                src='./../../img/MatchApp-Logo.png'\n                                height=\"50\"\n                                alt=\"MatchApp Logo\"/>\n                        </Navbar.Brand>\n                        <Navbar.Toggle/>\n                        <Navbar.Collapse>\n                            {this.showMenu()}\n                            <Nav>\n                                <div className=\"ConnectionNav m-1\">\n                                    {this.isConnected()}\n                                </div>\n                            </Nav>\n                        </Navbar.Collapse>\n                    </Navbar>\n                </div>\n            </div>\n        )\n    }\n}\n\n\nexport default withRouterAndRef(NavbarBootstrap);\n"]},"metadata":{},"sourceType":"module"}